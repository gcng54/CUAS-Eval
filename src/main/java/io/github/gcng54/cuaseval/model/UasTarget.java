package io.github.gcng54.cuaseval.model;

import java.time.Instant;
import java.util.Locale;
import java.util.UUID;

/**
 * Represents a UAS test target in the evaluation pipeline.
 * Generated by {@link io.github.gcng54.cuaseval.generator.TestTargetGenerator}.
 * <p>
 * Requirement links: FR01, FR02, FR09, FR11, FR12 (Detection targets)
 * </p>
 */
public class UasTarget {

    /** Unique target identifier (maps to FR17 — UID requirement) */
    private final String uid;

    /** Human-readable target designation */
    private String designation;

    /** UAS class per EU Regulation */
    private UasClass uasClass;

    /** Mass in grams */
    private double massGrams;

    /** Maximum speed in m/s */
    private double maxSpeedMs;

    /** Current position */
    private GeoPosition position;

    /** Current heading in degrees (0–360) */
    private double headingDeg;

    /** Current speed in m/s */
    private double speedMs;

    /** Whether target is carrying a payload (FR10, FR20, FR21) */
    private boolean hasPayload;

    /** Payload description */
    private String payloadDescription;

    /** Radar cross section in m² (for detection modelling) */
    private double rcsSqm;

    /** Whether this target is "friendly" (FR14 — IFF) */
    private boolean friendly;

    /** Creation/spawn time */
    private Instant spawnTime;

    /** Whether this UAS carries an EW jammer (EV-03) */
    private boolean hasJammer;

    /** Jammer output power in watts (used for EW effect calculation) */
    private double jammerPowerW;

    // ── Constructors ────────────────────────────────────────────────────

    public UasTarget() {
        this.uid = UUID.randomUUID().toString().substring(0, 8).toUpperCase();
        this.spawnTime = Instant.now();
        this.uasClass = UasClass.UNKNOWN;
    }

    public UasTarget(String designation, UasClass uasClass,
                     double massGrams, GeoPosition startPosition) {
        this();
        this.designation = designation;
        this.uasClass = uasClass;
        this.massGrams = massGrams;
        this.position = startPosition;
    }

    // ── Accessors ───────────────────────────────────────────────────────

    public String getUid()                 { return uid; }
    public String getDesignation()         { return designation; }
    public UasClass getUasClass()          { return uasClass; }
    public double getMassGrams()           { return massGrams; }
    public double getMaxSpeedMs()          { return maxSpeedMs; }
    public GeoPosition getPosition()       { return position; }
    public double getHeadingDeg()          { return headingDeg; }
    public double getSpeedMs()             { return speedMs; }
    public boolean isHasPayload()          { return hasPayload; }
    public String getPayloadDescription()  { return payloadDescription; }
    public double getRcsSqm()              { return rcsSqm; }
    public boolean isFriendly()            { return friendly; }
    public Instant getSpawnTime()          { return spawnTime; }
    public boolean isHasJammer()           { return hasJammer; }
    public double getJammerPowerW()        { return jammerPowerW; }

    public void setDesignation(String designation)             { this.designation = designation; }
    public void setUasClass(UasClass uasClass)                 { this.uasClass = uasClass; }
    public void setMassGrams(double massGrams)                 { this.massGrams = massGrams; }
    public void setMaxSpeedMs(double maxSpeedMs)               { this.maxSpeedMs = maxSpeedMs; }
    public void setPosition(GeoPosition position)              { this.position = position; }
    public void setHeadingDeg(double headingDeg)               { this.headingDeg = headingDeg; }
    public void setSpeedMs(double speedMs)                     { this.speedMs = speedMs; }
    public void setHasPayload(boolean hasPayload)              { this.hasPayload = hasPayload; }
    public void setPayloadDescription(String payloadDescription) { this.payloadDescription = payloadDescription; }
    public void setRcsSqm(double rcsSqm)                       { this.rcsSqm = rcsSqm; }
    public void setFriendly(boolean friendly)                   { this.friendly = friendly; }
    public void setSpawnTime(Instant spawnTime)                 { this.spawnTime = spawnTime; }
    public void setHasJammer(boolean hasJammer)                 { this.hasJammer = hasJammer; }
    public void setJammerPowerW(double jammerPowerW)            { this.jammerPowerW = jammerPowerW; }

    @Override
    public String toString() {
        return String.format(Locale.ENGLISH, "UAS[%s] %s class=%s mass=%.0fg pos=%s",
                uid, designation, uasClass, massGrams, position);
    }
}
